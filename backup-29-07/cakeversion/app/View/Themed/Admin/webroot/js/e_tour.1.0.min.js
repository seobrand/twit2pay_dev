/*
 * ************************************************************* *
 * Name       : eTour                                            *
 * Date       : June 2012                                        *
 * Owner      : CreativeMilk                                     *
 * Url        : www.creativemilk.net                             *
 * Version    : 1.0                                              *
 * Updated    : --/--/----                                       *
 * Developer  : Mark                                             *
 * Dependency : jQuery UI core                                   *
 * Lib        : jQuery 1.7+                                      *
 * Licence    : NOT free                                         *
 * http://themeforest.net/item/elite-a-powerfull-responsive-admin-theme/2997200
 * ************************************************************* *
 */
  
;(function(a,b,c,d){a.fn.eTour=function(d){d=a.extend({},a.fn.eTour.options,d);return this.each(function(){function k(c,e,g,h){if(h!=true){var i=a(c).children('[data-tour-id="'+f+'"][data-tour-step="'+g+'"]');if(e=="step"||a(c).outerHeight()>=a(b).height()){var j=i.offset().top-a(b).height()/2+i.outerHeight()/2}else{var j=a(c).offset().top-a(b).height()/2+a(c).outerHeight()/2}}else{var j=0}a("html, body").animate({scrollTop:j},d.effectSpeed)}function n(a,c){function d(){function b(a,b,c){var d=(Math.floor(a/b)%c).toString();if(d.length<2){var d="0"+d}return d}mins=b(a,6e4,60);secs=b(a,1e3,60);c.html(mins+":"+secs)}b.cInter=setInterval(function(){if(a!=0){a-=1e3;d()}},1e3)}var e=a(this);var f=Math.floor(Math.random()*1111);var g=8;var h=[];var i=d.step.length;if("ontouchstart"in b||b.DocumentTouch&&c instanceof DocumentTouch){var j="click tap"}else{var j="click"}a.each(d.step,function(b,c){var e='<div class="e-tour" style="display:none;" data-tour-id="'+f+'" data-tour-step="'+b+'">'+"<span></span>"+'<div class="e-tour-inner">'+'<header class="e-tour-header"></header>'+'<div class="e-tour-content"></div>'+'<footer class="e-tour-footer"></footer>'+"</div>"+"</div>";a(c.hookTo).css({position:"relative"}).append(e).children('[data-tour-step="'+b+'"]').css({width:c.width}).find("header.e-tour-header").text(c.title).next("div.e-tour-content").append(a(c.content)).children().css({width:c.width-20}).show();var h=a(c.hookTo).children('[data-tour-id="'+f+'"][data-tour-step="'+b+'"]');if(d.type=="timer"&&d.showTimer===true){h.find(".e-tour-footer").append('<div class="e-tour-timer">'+d.timerLabel+"<span></span></div>")}else if(d.type=="step"){if(b==0){var j='<a href="javascript:void(0);" class="e-tour-btn-next">'+c.nextLabel+"</a>"}else if(i==b+1){var j='<a href="javascript:void(0);" class="e-tour-btn-prev">'+c.prevLabel+'</a><a href="javascript:void(0);" class="e-tour-btn-stop">'+d.endLabel+"</a>"}else{var j='<a href="javascript:void(0);" class="e-tour-btn-prev">'+c.prevLabel+'</a><a href="javascript:void(0);" class="e-tour-btn-next">'+c.nextLabel+"</a>"}h.find("footer.e-tour-footer").append("<div>"+j+"</div>")}else{h.find("footer.e-tour-footer").remove()}var k=a(c.hookTo).outerWidth();var l=a(c.hookTo).outerHeight();var m=h.outerWidth();var n=h.outerHeight();if(d.showArrow===true){h.addClass("e-tour-arrow-"+c.arrowPosition);var o=g}else{h.children("span").remove();var o=0}if(d.draggable===true){h.addClass("e-tour-draggable")}if(c.offsetY){var p=c.offsetY}else{var p=0}if(c.offsetX){var q=c.offsetX}else{var q=0}switch(c.arrowPosition){case"tl":h.css({left:q,top:-n-o-p});break;case"tm":h.css({left:"50%",marginLeft:-(m/2-p),top:-n-o-p});break;case"tr":h.css({right:q,top:-n-o-p});break;case"rt":h.css({left:k+q+o,top:p});break;case"rm":h.css({left:k+q+o,top:"50%",marginTop:-(n/2-p)});break;case"rb":h.css({left:k+q+o,bottom:p});break;case"bl":h.css({left:q,bottom:-n-o-p});break;case"bm":h.css({left:"50%",marginLeft:-(m/2-p),bottom:-n-o-p});break;case"br":h.css({right:q,bottom:-n-o-p});break;case"lt":h.css({right:k+q+o,top:p});break;case"lm":h.css({right:k+q+o,top:"50%",marginTop:-(n/2-p)});break;case"lb":h.css({right:k+q+o,bottom:p});break}});if(d.time.length){if(d.time.indexOf(":")==-1){alert("Please use the right time format (mm:ss)")}var l=d.time.split(":").reverse();var m=parseInt(l[0]*1e3+l[1]*6e4)}else{var m=1e3}e.on(j,this,function(c){if(d.type=="timer"){a.each(d.step,function(c,e){h.push(setTimeout(function(){var g=a(e.hookTo).children('[data-tour-id="'+f+'"][data-tour-step="'+c+'"]');if(d.showTimer===true){clearInterval(b.cInter);n(m,g.find(".e-tour-timer span"))}a('[data-tour-id="'+f+'"]').not(g).fadeOut(d.effectSpeed);g.fadeIn(d.effectSpeed);k(e.hookTo,e.center,c,"");if(typeof e.onShow=="function"){e.onShow.call(this)}if(i==c+1){setTimeout(function(){a('[data-tour-id="'+f+'"]').fadeOut(d.effectSpeed);k("","","",true)},m)}},m*c))})}else if(d.type=="all"){a('[data-tour-id="'+f+'"]').fadeIn(d.effectSpeed)}else{if(a('[data-tour-id="'+f+'"]').is(":hidden")){k(d.step[0].hookTo,d.step[0].center,0,"");a('[data-tour-id="'+f+'"][data-tour-step="0"]').fadeIn(d.effectSpeed)}}c.preventDefault()});if(d.type=="step"){if(d.easyCancel===true){a(c).on(j,this,function(b){if(!a(b.target).is(a(" *",'[data-tour-id="'+f+'"]'))&&!a(b.target).is(a(" *",e))&&!a(b.target).is(a(e))){a('[data-tour-id="'+f+'"]').hide()}b.preventDefault()})}a("body").on(j,".e-tour-btn-prev, .e-tour-btn-next",function(b){var c=a(this).parents('[data-tour-id="'+f+'"]').data("tour-step");if(a(b.target).hasClass("e-tour-btn-prev")){var e=c-1}else{var e=c+1}var g=d.step[e].hookTo;var h=d.step[e].center;a('[data-tour-id="'+f+'"]:not([data-tour-step="'+e+'"])').fadeOut(d.effectSpeed);a('[data-tour-id="'+f+'"][data-tour-step="'+e+'"]').fadeIn(d.effectSpeed);k(g,h,e,"");b.preventDefault()})}a("body").on(j,d.stopButton+" ,a.e-tour-btn-stop",function(b){if(d.type=="timer"){a.each(h,function(a,b){clearTimeout(b)});h=[]}a('[data-tour-id="'+f+'"]').fadeOut(d.effectSpeed);if(typeof value.onStop=="function"){value.onStop.call(this)}b.preventDefault()});if(d.draggable===true){a("div.e-tour-draggable").draggable({handle:".e-tour-header"})}})};a.fn.eTour.options={type:"step",time:"00:30",showTimer:true,showArrow:true,timerLabel:"Next step in: ",stopButton:"#e-tour-stop",draggable:false,effectSpeed:0,easyCancel:true,endLabel:"End",step:[{hookTo:"",content:"",width:300,title:"",arrowPosition:"rb",offsetY:0,offsetX:0,prevLabel:"Go back",nextLabel:"Continue",center:"hook",onShow:function(){}}],onStop:function(){}}})(jQuery,window,document)